function rsCatalogSectionAjaxRefresh(e,a){var t=$("#"+e.ajaxId),o={type:"POST",url:e.url,data:{},success:function(o){var r=BX.parseJSON(o);if(e.historyPush&&"replaceState"in window.history)if("popstate"!=e.type){var i=null;if(i={isAjax:!0,url:e.url,id:e.ajaxId},e.url=e.url.indexOf("#")<0?e.url+"#"+e.ajaxId:e.url,window.history.replaceState(i,null,e.url),t.length>0){var s=$(window).scrollTop(),n=s+$(window).height(),l=t.offset().top;(l<s||l>n)&&$("html, body").animate({scrollTop:l},1e3)}}else window.location.hash=e.ajaxId;if(null==r)t.html(o);else for(var c in r)$("#"+c).html(r[c]);$(a.target).parent().addClass("active").siblings().removeClass("active"),appSLine.setProductItems()},error:function(){console.warn("sorter - change template -> error responsed")},complete:function(){appSLine.ajaxExec=!1,t.rsToggleDark()}};appSLine.ajaxExec||"#"==o.url||void 0==o.url||(t.rsToggleDark({progress:!0,progressTop:"100px"}),appSLine.ajaxExec=!0,o.url+=(o.url.indexOf("?")<0?"?":"&"!=o.url.slice(-1)?"&":"")+"rs_ajax=Y",void 0!=e.ajaxId&&(o.url+="&ajax_id="+e.ajaxId),$.ajax(o))}$(document).ready(function(){$(".js_popup_detail").fancybox({width:1170,wrapCSS:"popup_detail",fitToView:!0,autoSize:!0,openEffect:"fade",closeEffect:"fade",padding:[25,20,25,20],helpers:{title:null},ajax:{dataType:"html",headers:{popup_detail:"Y"}},beforeLoad:function(){this.href=this.href+(0<this.href.indexOf("?")?"&":"?")+"popup_detail=Y"},beforeShow:function(){appSLine.setProductItems()},afterClose:function(){appSLine.setProductItems()},afterShow:function(){$(".fancybox-inner").css("overflow","visible")}})}),$(document).on("mouseenter",".catalog_item",function(){$(this).addClass("is-hover")}),$(document).on("mouseleave",".catalog_item",function(){$(this).removeClass("is-hover").find(".div_select.opened").removeClass("opened").addClass("closed")}),$(window).on("scroll",function(){$(".js-ajaxpages_auto").each(function(){var e=$(this);200>e.offset().top-window.pageYOffset-$(window).height()&&!appSLine.ajaxExec&&e.find("a").trigger("click")})}),$(document).on("click",".js-catalog_refresh a",function(e){var a=$(this),t=a.attr("href").split("+").join("%2B"),o=a.closest(".js-catalog_refresh"),r=o.data("ajax-id"),i={url:t,ajaxId:r};void 0!=o.data("history-push")&&(i.historyPush=!0),rsCatalogSectionAjaxRefresh(i,e),e.preventDefault()}),$(document).on("click",".js-ajaxpages a",function(e){var a=$(this),t=a.attr("href"),o=a.closest(".js-ajaxpages"),r=o.data("ajax-id"),i={type:"POST",url:t,success:function(e){var a=BX.parseJSON(e);if("replaceState"in window.history){var i=null;i={url:t,id:r},t=t.indexOf("#")<0?t+"#"+r:t,window.history.replaceState(i,null,t)}if(null==a)o.replaceWith(e);else for(var s in a)$("#"+s).html(a[s])},error:function(){console.warn("ajaxpages -> error responsed")},complete:function(){appSLine.ajaxExec=!1,o.rsToggleDark()}};i.url+=(i.url.indexOf("?")<1?"?":"&"!=i.url.slice(-1)?"&":"")+"rs_ajax=Y&ajax_type=pages",o.length>0&&!appSLine.ajaxExec&&(appSLine.ajaxExec=!0,o.rsToggleDark(),$.ajax(i)),e.preventDefault()}),window.addEventListener("popstate",function(e){null!==e&&(null===e.state||$.isEmptyObject(e.state)||(e.state.isAjax?e.state.id&&e.state.url?rsCatalogSectionAjaxRefresh({url:e.state.url,ajaxId:e.state.id,type:"popstate"},e):e.state.url?window.location.href=e.state.url:window.location.reload():window.location.reload()))},!1);
